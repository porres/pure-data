#N canvas 484 38 626 796 12;
#X declare -stdpath ./;
#X obj 123 555 cos~;
#X obj 123 496 *~;
#X obj 163 555 cos~;
#X obj 236 506 wrap~;
#X obj 200 506 -~;
#X obj 163 532 +~;
#X obj 163 597 -~;
#X obj 193 628 *~;
#X obj 157 633 +~;
#X obj 200 474 samphold~;
#X floatatom 200 267 4 0 127 0 - \$0-center-freq - 0;
#X obj 200 341 line~;
#X obj 200 317 pack 0 50;
#X obj 123 417 phasor~;
#X floatatom 123 313 4 0 127 0 - \$0-fundamental - 0;
#X floatatom 361 335 4 0 127 0 - \$0-bandwidth - 0;
#X obj 361 406 line~;
#X obj 343 542 *~;
#X obj 361 383 pack 0 50;
#X obj 298 511 cos~;
#X obj 298 486 -~ 0.25;
#X obj 188 666 *~;
#X text 346 624 waveshaper;
#X obj 123 337 mtof;
#X obj 218 369 expr 1/$f1;
#X obj 200 293 mtof;
#X obj 200 393 *~;
#X obj 361 357 mtof;
#X obj 361 442 *~;
#X obj 361 486 *~ 25;
#X text 391 441 divide by fundamental;
#X text 409 485 range for table;
#X text 206 413 C.F. relative;
#X text 207 429 to fundamental;
#X text 120 665 ring mod;
#X obj 188 703 output~;
#X obj 298 461 *~ 0.5;
#X text 23 66 The more "natural" units for describing a formant might be center frequency and bandwidth \, so that you can change the fundamental without having the formant shift up and down in parallel. Here all three frequencies are expressed in MIDI units. The bandwidth and center frequency have to be divided by the fundamental (the expr 1/$f1 takes its reciprocal and two [*~] objects finish the division.), f 81;
#X text 85 275 fundamental (MIDI units), f 12;
#X obj 42 19 cnv 5 5 25 empty empty Changing\ PAF\ Controls\ to\ Natural\ Units 15 13 0 16 #dfdfdf #202020 0;
#N canvas 761 333 560 373 table 0;
#X obj 75 92 t b b;
#X obj 153 161 f;
#X obj 191 161 + 1;
#X msg 171 131 0;
#X obj 75 121 until;
#X obj 153 196 t f f;
#X obj 55 275 expr exp(-$f1*$f1);
#N canvas 0 0 450 300 (subpatch) 0;
#X array half-gauss 100 float 0;
#A color 0;
#A width 1;
#X coords 0 1 99 0 243 162 1;
#X restore 284 146 graph;
#X obj 75 56 bng 19 250 50 0 empty empty empty 0 -10 0 12 #dfdfdf #000000 #000000;
#X text 101 55 <- remake the table;
#X obj 87 187 sel 99;
#X obj 55 246 / 25;
#X obj 55 311 tabwrite half-gauss;
#X obj 75 26 loadbang;
#X connect 0 0 4 0;
#X connect 0 1 3 0;
#X connect 1 0 2 0;
#X connect 1 0 5 0;
#X connect 1 0 10 0;
#X connect 2 0 1 1;
#X connect 3 0 1 1;
#X connect 4 0 1 0;
#X connect 5 0 11 0;
#X connect 5 1 12 1;
#X connect 6 0 12 0;
#X connect 8 0 0 0;
#X connect 10 0 4 1;
#X connect 11 0 6 0;
#X connect 13 0 8 0;
#X restore 458 708 pd table;
#N canvas 238 316 365 358 init 0;
#X obj 125 294 declare -stdpath ./;
#X obj 131 97 loadbang;
#X text 81 28 This subpatch initializes the patch and loads a value in the number boxes., f 29;
#X obj 131 126 bng 19 250 50 0 empty empty empty 0 -10 0 12 #dfdfdf #000000 #000000;
#X obj 131 153 f \$0;
#X msg 131 183 \; \$1-fundamental 48 \; \$1-center-freq 60 \; \$1-bandwidth 72;
#X connect 1 0 3 0;
#X connect 3 0 4 0;
#X connect 4 0 5 0;
#X restore 379 708 pd init;
#X text 234 267 center freq. (also MIDI);
#X text 400 335 bandwidth (MIDI);
#X obj 343 581 tabread4~ half-gauss, f 10;
#X text 23 154 Here we take a somewhat lax approach to sampholding the center frequency control. The frequency itself changes instantly \, but the center/fundamental frequency ratio waits for the next period. This gives a slight "chirp" if the fundamental is abruptly raised a couple of octaves. There's no easy way using Pd's built-in primitives to avoid this. Note that now we only compute the second half of the gaussian table \, which is the part we were effectively using., f 81;
#X connect 0 0 6 1;
#X connect 0 0 8 0;
#X connect 1 0 5 0;
#X connect 1 0 0 0;
#X connect 2 0 6 0;
#X connect 3 0 4 1;
#X connect 3 0 7 1;
#X connect 4 0 1 1;
#X connect 5 0 2 0;
#X connect 6 0 7 0;
#X connect 7 0 8 1;
#X connect 8 0 21 0;
#X connect 9 0 4 0;
#X connect 9 0 3 0;
#X connect 10 0 25 0;
#X connect 11 0 26 0;
#X connect 12 0 11 0;
#X connect 13 0 9 1;
#X connect 13 0 1 0;
#X connect 13 0 5 1;
#X connect 13 0 36 0;
#X connect 14 0 23 0;
#X connect 15 0 27 0;
#X connect 16 0 28 0;
#X connect 17 0 44 0;
#X connect 18 0 16 0;
#X connect 19 0 17 0;
#X connect 20 0 19 0;
#X connect 21 0 35 0;
#X connect 23 0 24 0;
#X connect 23 0 13 0;
#X connect 24 0 26 1;
#X connect 24 0 28 1;
#X connect 25 0 12 0;
#X connect 26 0 9 0;
#X connect 27 0 18 0;
#X connect 28 0 29 0;
#X connect 29 0 17 1;
#X connect 36 0 20 0;
#X connect 44 0 21 1;
